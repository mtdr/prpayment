# Payments sharder
It's an education project oriented on sharding technologies based on Spring Framework

Проект для демонстрации ручного шардирования данных в базе. 

Предметная основа - платежи и их участники.
Участники хранятся в едином состоянии на каждом шарде для целостности данных. 
Платежи распределяются по шардам алгоритмом, в основе которого определение остатка от деления значения хэш-функции на количество шардов (сейчас - 3..

Установка:
1. Создать 3 базы данных в postgres - prpayment1, prpayment2, prpayment3;
2. Запустить проект со значением параметра spring.jpa.hibernate.ddl-auto=update (или create.;
3. Остановить проект, снять дамп с prpayment1, восстановить prpayment2 и prpayment3 из него;
4. Проект готов к работе, запустить

Использование:
1. Доступные REST API описаны для использования со Swagger UI на http://localhost:8080/swagger-ui.html
2. Для быстрого ознакомления рекомендуется следующий сценарий:
    - генерация участников и платежей - пустой POST запрос на (/api/payments/generate/save/all). В ответном сообщении будет список сохраненных платежей.
    - вызов контроллера для подсчета суммы платежей по участнику (/api/payments/sum) с телом вида {"data": "a"}, где "a" - ParticipantEntity#name. В ответном сообщении будет указана суммаа платежей, отправленных участником во всей системе.
    - получение суммы платежей участника, хранимых на конкретном шарде. Получение суммы доступно по POST-запросу на (/api/payments/sum/shard) с телом вида {"data": ["a", 2]}, где "a" - ParticipantEntity#name, 2 - номер шарда (от 1 до 3)